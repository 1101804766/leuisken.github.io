<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="description" content="比亚迪元，给你想要的青春。">
  <title>这不是我要的青春</title>
  <link rel="stylesheet" type="text/css" href="./style/normalize.css">
  <!-- <link rel="stylesheet" type="text/css" href="./style/animate.css"> -->
  <link rel="stylesheet" type="text/css" href="./style/style.css">
  <script type="text/javascript" src="./scripts/css3d.js"></script>
</head>
<body scroll="no">
  <div id="main">
    <div id="world"></div>
    <div id="start"></div>
    <div id="page2"></div>
    <div id="page3"></div>
    <div id="page4"></div>
    <div id="page5"></div>
    <div id="page6"></div>
    <div id="page7"></div>
  </div>
</body>
<script type="text/javascript">

var stage = new C3D.Stage() 
stage.size(window.innerWidth, window.innerHeight).material({
  color: '#000000',
  image: './images/index_bg.jpg'
}).update()

document.getElementById('world').appendChild(stage.el)

var indexSprite = new C3D.Sprite()
indexSprite.position(0, 0, -600).update()
stage.addChild(indexSprite)

var car = new C3D.Plane()
car.size(430, 342).position(0, 0, -9000).material({
  image: './images/index_car.png'
}).update()

indexSprite.addChild(car)

var charSprite = new C3D.Sprite()
charSprite.position(0, 250, 0).update()
indexSprite.addChild(charSprite)

var largeChar = new C3D.Plane()
largeChar.size(204, 100).position(0, 300, 300).material({
  image: './images/index_char_lar.png'
}).update()

charSprite.addChild(largeChar)

var smallChar = new C3D.Plane()
smallChar.size(305, 37).position(0, 300, 300).rotation(0, 0, 180).material({
  image: './images/index_char_sm.png'
}).update()

charSprite.addChild(smallChar)

//刷新场景
requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
function(callback) {
  setTimeout(callback, 1000 / 60);
};

function changeStage() {
  document.getElementById('main').style.top = -window.innerHeight + 'px'
  requestAnimationFrame(s1);
  document.removeEventListener('click', changeStage)
}

function go() {
  if (car.z < -300) {
    car.move(0, 0, 200).update()
  } else if (largeChar.z > 0) {
    largeChar.move(0, -10, -10).update()
  }
  if (largeChar.z < 150) {
    smallChar.move(0, -10, -10).rotation(0, 0, smallChar.rotationZ - 6).update()
  };
  if (largeChar.z <= 0 && smallChar.rotationZ === 0) {
    document.addEventListener('click', changeStage)
    return 
  }
  requestAnimationFrame(go);
}

requestAnimationFrame(go);

var mainStage = new C3D.Stage()
mainStage.size(window.innerWidth, window.innerHeight).material({
  color: '#cccccc',
  image: './images/page1_bg.jpg'
}).update()

document.getElementById('start').appendChild(mainStage.el)

var page1 = new C3D.Plane()
page1.origin(0, 0, 0).position(0, 0, -800).update()
mainStage.addChild(page1)

var page1Car = new C3D.Plane()
page1Car.size(569, 319, 20).position(-3000, -1000, -8200).material({
  image: './images/page1_car.png'
}).update()
page1.addChild(page1Car)

var page1Sprite = C3D.create({
  type: 'sprite',
  position: [-700, -970, 0],
  children: [
    {
      type: 'plane',
      size: [1000, 900],
      position: [0, 0, 0],
      material: [{image: './images/page_rect.png'}]
    },
    {
      type: 'plane',
      size: [417, 57],
      position: [0, 0, 0],
      material: [{image: './images/page1_char_sm.png'}]
    },
    {
      type: 'plane',
      size: [210, 94],
      position: [200, 110, 0],
      material: [{image: './images/page1_char_lar.png'}]
    }
  ]
}).update()
page1.addChild(page1Sprite)

var page2Sprite = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  rotation: [0, 270, 0],
  children: [
    {
      type: 'plane',
      position: [0, 0, -85],
      size: [window.innerWidth, window.innerHeight],
      material: [{image: './images/page2_bg.jpg'}]
    }
  ]
})

mainStage.addChild(page2Sprite)

function s1() {
  if (page1Car.z < 0) {
    page1Car.move(72, 30.952380, 200).update()
  } else if (page1Sprite.x < 0) {
    page1Sprite.move(20, 20, 0).update()
  } else if(page1.rotationY !== 90) {
    if (page1.rotationY === 0) {
      setTimeout(function() {
        page1.rotationY += 3
        requestAnimationFrame(s1);
      }, 1000)
      return
    }
    page1.rotate(0, 3, 0).update()
  } else {
    page2Sprite.rotate(0, 3, 0).update()
    if (page2Sprite.rotationY === 360) {
      document.getElementById('main').style.top = -window.innerHeight*2 + 'px'
      requestAnimationFrame(s2);
      return 
    }
  }
  requestAnimationFrame(s1);
}

var page2Stage = new C3D.Stage()
page2Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  image: './images/page2_bg.jpg'
}).update()
document.getElementById('page2').appendChild(page2Stage.el)

var page2 = new C3D.Plane()
page2.origin(0, 0, 0).position(0, 0, -800).update()
page2Stage.addChild(page2)

var page2Car = new C3D.Plane()
page2Car.size(569, 319, 20).position(3000, -1000, -8200).material({
  image: './images/page2_car.png'
}).update()
page2.addChild(page2Car)

var page2SpriteExtra = C3D.create({
  type: 'sprite',
  position: [800, -1050, 0],
  children: [
    {
      type: 'plane',
      size: [1000, 900],
      position: [0, 0, 0],
      material: [{image: './images/page2_rect.png'}]
    },
    {
      type: 'plane',
      size: [356, 147],
      position: [0, 0, 0],
      material: [{image: './images/page2_char_lar.png'}]
    }
  ]
}).update()
page2.addChild(page2SpriteExtra)

var page3Sprite = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  rotation: [270, 0, 0],
  children: [
    {
      type: 'plane',
      position: [0, 0, -260],
      size: [window.innerWidth, window.innerHeight],
      material: [{image: './images/page3_bg.jpg'}]
    }
  ]
})

page2Stage.addChild(page3Sprite)

function s2() {
  if (page2Car.z < 0) {
    page2Car.move(-72, 30.952380, 200).update()
  } else if (page2SpriteExtra.x > 0) {
    page2SpriteExtra.move(-20, 20, 0).update()
  } else if (page2.rotationX !== 90) {
    if (page2.rotationX === 0) {
      setTimeout(function() {
        page2.rotationX += 3
        requestAnimationFrame(s2);
      }, 1000)
      return
    }
    page2.rotate(3, 0, 0).update()
  } else {
    page3Sprite.rotate(3, 0, 0).update()
    if (page3Sprite.rotationX === 360) {
      document.getElementById('main').style.top = -window.innerHeight*3 + 'px'
      requestAnimationFrame(s3);
      return 
    }
  }
  requestAnimationFrame(s2);
}

var page3Stage = new C3D.Stage()
page3Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  image: './images/page3_bg.jpg'
}).update()
document.getElementById('page3').appendChild(page3Stage.el)

var page3 = new C3D.Plane()
page3.origin(0, 0, 0).position(0, 0, -800).update()
page3Stage.addChild(page3)

var page3SpriteExtra = C3D.create({
  type: 'sprite',
  position: [1000, 0, 0],
  children: [
    {
      type: 'plane',
      size: [800, 416],
      scale: [2, 2, 1],
      position: [0, 0, 0],
      material: [{image: './images/page3_person.png'}]
    },
    {
      type: 'plane',
      name: 'text',
      size: [478, 202],
      position: [0, 200, 0],
      material: [{image: './images/page3_char_lar.png'}]
    }
  ]
}).update()
page3SpriteExtra.text.alpha = 0
page3SpriteExtra.text.update()
page3.addChild(page3SpriteExtra)

var page3Car = new C3D.Plane()
page3Car.size(569, 319, 20).position(-3000, -1000, -8200).material({
  image: './images/page1_car.png'
}).update()
page3.addChild(page3Car)

var page4Sprite = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  rotation: [270, 0, 0],
  children: [
    {
      type: 'plane',
      position: [0, 0, -260],
      size: [window.innerWidth, window.innerHeight],
      material: [{image: './images/page1_bg.jpg'}]
    }
  ]
})

page3Stage.addChild(page4Sprite)

function s3() {
  if (page3Car.z < 0) {
    page3Car.move(72, 21.42857, 200).update()
  } else if (page3SpriteExtra.x > 0) {
    page3SpriteExtra.move(-20, 0, 0).update()
  } else if (page3SpriteExtra.text.alpha < 1) {
    page3SpriteExtra.text.alpha += 0.02
    page3SpriteExtra.text.update()
  } else if (page3.rotationX !== 90) {
    if (page3.rotationX === 0) {
      setTimeout(function() {
        page3.rotationX += 3
        requestAnimationFrame(s3);
      }, 1000)
      return
    }
    page3.rotate(3, 0, 0).update()
  } else {
    page4Sprite.rotate(3, 0, 0).update()
    if (page4Sprite.rotationX === 360) {
      document.getElementById('main').style.top = -window.innerHeight*4 + 'px'
      requestAnimationFrame(s4);
      return 
    }
  }
  requestAnimationFrame(s3);
}

var page4Stage = new C3D.Stage()
page4Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  image: './images/page1_bg.jpg'
}).update()
document.getElementById('page4').appendChild(page4Stage.el)

var page4 = new C3D.Plane()
page4.origin(0, 0, 0).position(0, 0, -800).update()
page4Stage.addChild(page4)

var page4Container = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  children: [
    {
      type: 'plane',
      name: 'text',
      position: [0, 0, 0],
      size: [203, 540],
      material: [{image: './images/page4_char.png'}]
    },
    {
      type: 'plane',
      name: 'left_line',
      position: [0, 0, 0],
      size: [338, 2696],
      material: [{image: './images/page4_line_left.png'}]
    },
    {
      type: 'plane',
      name: 'right_line',
      position: [0, 0, 0],
      size: [565, 2569],
      material: [{image: './images/page4_line_right.png'}]
    }
  ]
})

page4Container.text.alpha = 0
page4Container.text.update()
page4.addChild(page4Container)

var page5Sprite = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  rotation: [270, 0, 0],
  children: [
    {
      type: 'plane',
      position: [0, 0, -260],
      size: [window.innerWidth, window.innerHeight],
      material: [{image: './images/page5_bg.jpg'}]
    }
  ]
})

page4Stage.addChild(page5Sprite)

function s4() {
  if (page4Container.left_line.x > -500) {
    page4Container.left_line.move(-10, -20, 0).update()
    page4Container.right_line.move(10, 20, 0).update()
    page4Container.text.alpha += 0.02
    page4Container.text.update()
  } else if (page4.rotationX !== 90) {
    if (page4.rotationX === 0) {
      setTimeout(function() {
        page4.rotationX += 3
        requestAnimationFrame(s4);
      }, 1000)
      return
    }
    page4.rotate(3, 0, 0).update()
  } else {
    page5Sprite.rotate(3, 0, 0).update()
    if (page5Sprite.rotationX === 360) {
      document.getElementById('main').style.top = -window.innerHeight*5 + 'px'
      requestAnimationFrame(s5);
      return 
    }
  }
  requestAnimationFrame(s4);
}

var page5Stage = new C3D.Stage()
page5Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  image: './images/page5_bg.jpg'
}).update()
document.getElementById('page5').appendChild(page5Stage.el)

var page5 = new C3D.Plane()
page5.origin(0, 0, 0).position(0, 0, -800).update()
page5Stage.addChild(page5)

var page5Container = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  children: [
    {
      type: 'plane',
      name: 'band',
      position: [0, 1000, 0],
      size: [809, 339],
      material: [{image: './images/page5_band.png'}]
    },
    {
      type: 'plane',
      name: 'car',
      position: [0, 370, 0],
      scale: [0, 0, 0],
      size: [601, 124],
      material: [{image: './images/page5_car.png'}]
    },
    {
      type: 'plane',
      name: 'char',
      position: [0, 0, 0],
      size: [430, 209],
      material: [{image: './images/page5_char.png'}]
    }
  ]
})

page5Container.char.alpha = 0
page5Container.char.update()
page5.addChild(page5Container)

var page6Sprite = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  rotation: [270, 0, 0],
  children: [
    {
      type: 'plane',
      position: [0, 0, -260],
      size: [window.innerWidth, window.innerHeight],
      material: [{image: './images/page6_bg.png'}]
    }
  ]
})

page5Stage.addChild(page6Sprite)

function s5() {
  if (page5Container.car.scaleX < 1) {
    page5Container.car.scale(page5Container.car.scaleX + 0.02, page5Container.car.scaleY + 0.02, page5Container.car.scaleX + 0.02).update()
  } else if (page5Container.band.y > 510) {
    page5Container.band.move(0, -10, 0).update()
  } else if (page5Container.char.alpha < 1) {
    page5Container.char.alpha += 0.02
    page5Container.char.update()
  } else if (page5.rotationX !== 90) {
    if (page5.rotationX === 0) {
      setTimeout(function() {
        page5.rotationX += 3
        requestAnimationFrame(s5);
      }, 1000)
      return
    }
    page5.rotate(3, 0, 0).update()
  } else {
    page6Sprite.rotate(3, 0, 0).update()
    if (page6Sprite.rotationX === 360) {
      document.getElementById('main').style.top = -window.innerHeight*6 + 'px'
      requestAnimationFrame(s6);
      return 
    }
  }
  requestAnimationFrame(s5);
}

var page6Stage = new C3D.Stage()
page6Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  color: '#000000',
  image: './images/page6_bg.png'
}).update()
document.getElementById('page6').appendChild(page6Stage.el)

var page6 = new C3D.Plane()
page6.origin(0, 0, 0).position(0, 0, -700).update()
page6Stage.addChild(page6)

var page6Container = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  children: [
    {
      type: 'plane',
      name: 'car',
      position: [0, 370, 0],
      size: [644, 337],
      material: [{image: './images/page6_car.png'}]
    },
    {
      type: 'plane',
      name: 'char',
      position: [0, 0, 0],
      size: [430, 201],
      material: [{image: './images/page6_char.png'}]
    }
  ]
})

page6Container.char.alpha = 0
page6Container.char.update()
page6.addChild(page6Container)

function s6() {
  if (page6Container.car.y < 720) {
    page6Container.car.move(0, 10, 0).update()
  } else if (page6Container.char.alpha < 1) {
    page6Container.char.alpha += 0.02
    page6Container.char.update()
  } else if (page6.rotationX !== 90) {
    if (page6.rotationX === 0) {
      setTimeout(function() {
        page6.rotationX += 3
        requestAnimationFrame(s6);
      }, 1000)
      return
    }
    page6.rotate(3, 0, 0).update()
  } else {
    document.getElementById('main').style.top = -window.innerHeight*7 + 'px'
    return 
  }
  requestAnimationFrame(s6);
}

var page7Stage = new C3D.Stage()
page7Stage.size(window.innerWidth, window.innerHeight).position(0, 0, 0).material({
  color: '#000000',
  image: './images/page5_bg.jpg'
}).update()
document.getElementById('page7').appendChild(page7Stage.el)

var page7 = new C3D.Plane()
page7.origin(0, 0, 0).position(0, 0, -700).update()
page7Stage.addChild(page7)

var page7Container = C3D.create({
  type: 'sprite',
  position: [0, 0, 0],
  children: [
    {
      type: 'plane',
      name: 's1',
      position: [0, 0, 0],
      size: [460, 377],
      material: [{image: './images/page7_s1.png'}]
    },
    {
      type: 'plane',
      name: 's2',
      position: [0, 0, 0],
      size: [482, 457],
      material: [{image: './images/page7_s2.png'}]
    },
    {
      type: 'plane',
      name: 's3',
      position: [0, 0, 0],
      size: [518, 457],
      material: [{image: './images/page7_s3.png'}]
    },
    {
      type: 'plane',
      name: 's4',
      position: [0, 0, 0],
      size: [476, 408],
      material: [{image: './images/page7_s4.png'}]
    },
    {
      type: 'plane',
      name: 'car',
      position: [0, 0, 0],
      size: [569, 319],
      material: [{image: './images/page1_car.png'}]
    },
    {
      type: 'plane',
      name: 'char',
      position: [0, 0, 0],
      size: [539, 274],
      material: [{image: './images/page7_char.png'}]
    }
  ]
})

page7.addChild(page7Container)

</script>
</html>